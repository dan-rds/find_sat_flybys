from spacetrack import SpaceTrackClient
import datetime as dt 
st = SpaceTrackClient('ddrichar@ucsc.edu', 'n3JYvGMWBb3Yv3e')


import spacetrack.operators as op
drange = op.inclusive_range(dt.datetime(2016, 6, 26),
							dt.datetime(2016, 6, 27))

# Streaming downloads line by line
lines = st.tle(iter_lines=True, epoch=drange, orderby='TLE_LINE1', format='3le')
with open('tle.txt', 'w') as fp:
	for line in lines:
		fp.write(line)
		fp.write("\n")


# Parameter checking, using Space-Track's modeldef API
#xst.tle_latest(norad_cat_id=25544)
#TypeError: 'tle_latest' got an unexpected argument 'onrad_cat_id'

# # Automatic rate limiting
# for satno in my_satnos:
# 	# Gets limited to <20 requests per minute automatically by blocking
# 	st.tle()


curl --limit-rate 1M --cookie cookies.txt https://www.space-track.org/basicspacedata/query/class/boxscore > boxscore.json
def read_config_file(config_filename) -> (ephem.Observer, dict):
# 	d = {}
# 	with open(config_filename, "r+") as config:
# 		d = dict(yaml.safe_load(config))
# 	# converting xyz -> lla
# 	ecef = pyproj.Proj(proj='geocent', ellps='WGS84', datum='WGS84')
# 	lla = pyproj.Proj(proj='latlong', ellps='WGS84', datum='WGS84')
# 	lon, lat, alt = pyproj.transform(ecef, lla, d['x'], d['y'], d['z'], radians=True) # Yes it returs lon, lat not la, lon
# 	ret_obs = ephem.Observer()
# 	ret_obs.lat = lat
# 	ret_obs.lon = lon
# 	ret_obs.elevation = alt

# 	d[lon] = lon
# 	d[lat] = lat
# 	d[alt] = alt
# 	return ret_obs, d